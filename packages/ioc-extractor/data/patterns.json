{
  "rules": [
    {
      "name": "create_process",
      "from": "api",
      "where": {
        "regex": "(?i)^(CreateProcess[WA])\\b"
      },
      "select": [
        {
          "alias": "lpApplicationName",
          "field": "parameters.lpApplicationName",
          "transform": ["regex:\"([A-Z]:\\\\[^\\\"]+\\.exe)\""]
        },
        {
          "alias": "lpCommandLine",
          "field": "parameters.lpCommandLine",
          "transform": ["regex:\"0x[0-9a-fA-F]+\\s+(.+)\"", "strip_quotes"]
        }
      ]
    },
    {
      "name": "create_file",
      "from": "api",
      "where": {
        "regex": "(?i)^(CreateFileW)\\b"
      },
      "select": [
        {
          "alias": "lpFileName",
          "field": "parameters.lpFileName",
          "transform": ["regex:\"([^\\\"]+)\"", "strip_quotes"]
        },
        {
          "alias": "dwDesiredAccess",
          "field": "parameters.dwDesiredAccess"
        },
        { "alias": "dwShareMode", "field": "parameters.dwShareMode" },
        {
          "alias": "dwCreationDisposition",
          "field": "parameters.dwCreationDisposition"
        }
      ]
    }
  ]
}
