# ðŸ›¡ï¸ Malware Downloader

A command-line tool to fetch malware samples, metadata, and behavioral intelligence from **[VirusTotal (VT)](https://www.virustotal.com)** and **[MalwareBazaar (MB)](https://bazaar.abuse.ch)** using file hashes. Offers fine-grained control over what to retrieve, making it ideal for streamlined and automated malware analysis workflows.

## ðŸ“¦ Getting Started

### 1. Clone the Repository

```bash
git clone https://github.com/reverseame/rme-toolkit.git
cd rme-toolkit/packages/malware-downloader
```

### 2. Install Dependencies

```bash
uv venv                             # Create a virtual environment
source .venv/bin/activate           # Activate it (use .venv\Scripts\activate on Windows)
```

```bash
uv pip compile pyproject.toml > requirements.txt
uv pip install -r requirements.txt
```

### 3. Configuration

Most of the operations will require authentication through API keys. This should be set in an `.env` file.

The repository offers a template file `.env.template` for reference.

> [!IMPORTANT]
> Remember to properly set the read permissions of files containing secrets.

### 4. Run the tool

```bash
uv run malware-downloader mb download --hashes hashes.txt --sample --metadata
```

## âœ¨ Features

- Fine-grained control over what data to retrieve.
- Skips downloads for existing files to avoid redundancy.
- Automatically organizes results into per-hash directories.
- Clean, human-readable logging with styled output.

## ðŸš€ Usage Example

```bash
uv run malware-downloader mb download --hashes hashes.txt --sample --metadata
```

## ðŸ“‚ Output

The tool generates an `output/` directory, containing one subfolder per hash. Each folder may include:

```
output/
â””â”€â”€ <HASH>/
    â”œâ”€â”€ virustotal.json         # Metadata from VirusTotal
    â”œâ”€â”€ vt_*                    # Additional files from VirusTotal
    â”œâ”€â”€ malwarebazaar.json      # Metadata from MalwareBazaar
    â”œâ”€â”€ mb_*                    # Additional files from mb
    â””â”€â”€ <HASH>.zip              # Binary sample (if downloaded)
```
